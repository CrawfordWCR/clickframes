<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<appspec xmlns="http://www.clickframes.org" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  defaultPage="login" id="issuetracker">
  <title>Issue Tracker</title>
  <description>
    The Issue Tracker allows a team to record their progress on
    collaborative tasks.
    </description>
  <outcomes>
    <outcome id="error">
      <title>Default Error Outcome</title>
      <description>
        Should an unexpected operational error occur during any
        transition,
        this outcome will define the destination (i.e. error)
        page.
        </description>
      <pageRef>error</pageRef>
    </outcome>
  </outcomes>
  <linkSets>
    <linkSet id="global" global="true">
      <title>Global Navigation</title>
      <links>
        <link>
          <title>Home</title>
          <pageRef>login</pageRef>
        </link>
        <link>
          <title>Contact Us</title>
          <pageRef>contact</pageRef>
        </link>
        <link>
          <title>Privacy Policy</title>
          <pageRef>privacy</pageRef>
        </link>
        <link>
          <title>About</title>
          <pageRef>about</pageRef>
        </link>
      </links>
    </linkSet>
    <linkSet id="authenticated">
      <title>Authenticated Navigation</title>
      <links>
        <link>
          <title>View Issues</title>
          <pageRef>viewIssues</pageRef>
        </link>
        <link>
          <title>Add New Issue</title>
          <pageRef>newIssue</pageRef>
        </link>
        <link>
          <title>Change Password</title>
          <pageRef>changePassword</pageRef>
        </link>
      </links>
    </linkSet>
  </linkSets>

  <entities>
    <entity id="user">
      <title>User</title>
      <description>User</description>
      <properties>
        <property id="username" primaryKey="true">
          <title>Username</title>
          <description>The username of the user</description>
        </property>

        <property id="password">
          <title>Password</title>
          <description>The password of the user</description>
        </property>
      </properties>
    </entity>

    <entity id="issue">
      <title>Issue</title>
      <description>Issue</description>
      <properties>
        <property id="id" primaryKey="true">
          <title>Id</title>
        </property>
        <property id="title">
          <title>Title</title>
        </property>
        <property id="description">
          <title>Description</title>
        </property>
        <property id="priority">
          <title>Priority</title>
          <options>
            <option value="high">High</option>
            <option value="normal">Normal</option>
            <option value="low">Low</option>
          </options>
          <default value="normal" />

        </property>
        <property id="assignee">
          <title>Assignee</title>
          <description>Whom is the project assigned to? The id of the user in the project</description>
          <options>
            <option value="jonathan">Jon</option>
            <option value="steven">Steven</option>
            <option value="evan">Evan</option>
            <option value="nicole">Nicole</option>
            <option value="vineet">Vineet</option>
            <option value="will">Will</option>
          </options>
        </property>
        <property id="environment">
          <title>Environment</title>
          <description>The environment of where the issue was found. Valid values, 'Production', 'Testing' and 'Development'</description>
          <options>
            <option value="prod">Production</option>
            <option value="test">Testing</option>
            <option value="dev">Development</option>
          </options>
        </property>
      </properties>
    </entity>
  </entities>

  <pages>
    <page id="login">
      <title>Home</title>
      <description>
      This page introduces the user to Issue Tracker and
      shows a login
      form.
        </description>
      <facts>
        <fact>
        Authentication will be handled by a back-end service defined
        by the
        client.
        </fact>
        <fact>
        Three consecutive login failures within a 30 minute period
        will lock
        the user's account for one hour.
        </fact>
      </facts>
      <forms>
        <form id="loginForm">
          <inputs>
            <input id="username" type="text" loginUsername="true">
              <entityPropertyRef entity="user"
                property="username" />
              <title>Username</title>
              <validations>
                <validation type="required"
                  description="Please enter your username." />
              </validations>
            </input>
            <input id="password" type="password" loginPassword="true">
              <entityPropertyRef entity="user"
                property="password" />
              <title>Password</title>
              <validations>
                <validation type="required"
                  description="Please enter your password." />
              </validations>
            </input>
          </inputs>
          <actions>
            <action id="login" loginAction="true">
              <title>Login</title>
              <outcomes>
                <outcome id="loginSuccessful"
                  loginSuccessfulOutcome="true">
                  <title>Login successful</title>
                  <pageRef>viewIssues</pageRef>
                  <facts>
                    <fact>
                  Seam Authentication automatically displays welcome
                  message
                    </fact>
                  </facts>
                </outcome>
                <outcome id="loginFailed" loginFailedOutcome="true"
                  negative="true">
                  <title>Login failed</title>
                  <pageRef>login</pageRef>
                  <message>Sorry, your username or password are not correct.</message>
                </outcome>
              </outcomes>
            </action>
          </actions>
        </form>
      </forms>
      <links>
        <link>
          <title>Create Account</title>
          <pageRef>createAccount</pageRef>
        </link>
      </links>
    </page>
    <page id="createAccount">
      <title>Create An Account</title>
      <description>
      This page shows the user an account creation form.
      Login not
      required.
        </description>
      <forms>
        <form id="createAccountForm">
          <inputs>
            <input type="text">
              <entityPropertyRef entity="user"
                property="username" />
              <title>Username</title>
              <validations>
                <validation type="required" description="Please enter a username." />
              </validations>
            </input>
            <input type="password">
              <entityPropertyRef entity="user"
                property="password" />
              <title>Password</title>
              <validations>
                <validation type="required" description="Please enter a password." />
                <validation type="length(min=6)"
                  description="Password must be at least 6 characters." />
              </validations>
            </input>
            <input type="password">
              <title>Repeat Password</title>
              <description>User must enter password twice so it can be
              validated for accuracy.</description>
              <validations>
                <validation type="required"
                  description="Please repeat your password." />
              </validations>
            </input>
          </inputs>
          <actions>
            <action id="createAccount" type="create">
              <title>Create account</title>
              <outcomes>
                <outcome id="accountCreated">
                  <title>Account created</title>
                  <description>
                  User's account has been successfully
                  created.
                    </description>
                  <pageRef>login</pageRef>
                  <message>
                  Your account has been created. Please log in.
                    </message>
                </outcome>
              </outcomes>
            </action>
          </actions>
        </form>
      </forms>
    </page>
    <page id="changePassword" login-required="true">
      <title>Change Password</title>
      <description>
      This page lets the user change his password. Login
      required.
    </description>
      <facts>
        <fact>
        The user may not change their password to any of their ten
        previous
        passwords.
        </fact>
      </facts>
      <forms>
        <form id="changePasswordForm">
          <inputs>
            <input type="password">
              <title>Current Password</title>
              <validations>
                <validation type="required"
                  description="Please enter your current password." />
              </validations>
            </input>
            <input type="password">
              <title>New Password</title>
              <validations>
                <validation type="required"
                  description="Please enter a new password." />
                <validation type="length(min=6)"
                  description="New password must be at least 6 characters." />
              </validations>
            </input>
            <input type="password">
              <title>Repeat New Password</title>
              <validations>
                <validation type="required"
                  description="Please repeat your new password." />
                <validation type="length(min=6)"
                  description="New password must be at least 6 characters." />
              </validations>
            </input>
          </inputs>
          <actions>
            <action>
              <title>Change Password</title>
              <outcomes>
                <outcome id="passwordChanged">
                  <title>Password changed successfully</title>
                  <pageRef>viewIssues</pageRef>
                  <message>
                  Your password has been changed.
                    </message>
                </outcome>
                <outcome id="wrongOldPassword" negative="true">
                  <title>Current password is incorrect</title>
                  <pageRef>changePassword</pageRef>
                  <message>
                  Sorry, the current password you entered is
                  incorrect.
                    </message>
                </outcome>
                <outcome id="passwordsDontMatch" negative="true">
                  <title>New passwords do not match</title>
                  <pageRef>changePassword</pageRef>
                  <message>
                  Sorry, new passwords do not match.
                    </message>
                </outcome>
              </outcomes>
            </action>
          </actions>
        </form>
      </forms>
      <linkSetRefs>
        <linkSetRef id="authenticated" />
      </linkSetRefs>
    </page>
    <page id="viewIssues" login-required="true">
      <title>View Issues</title>
      <description>
      This page shows the user all of his team's issues.
        </description>
      <linkSetRefs>
        <linkSetRef id="authenticated" />
      </linkSetRefs>
      <outputLists>
        <outputList entityRef="issue" id="teamIssues">
          <title>My Team's Issues</title>
          <description>All issues belonging to user's team</description>
          <facts>
            <fact>A link per issue listed to view the issue</fact>
          </facts>
          <links>
            <link>
              <title>View Issue</title>
              <pageRef>viewIssue</pageRef>
            </link>
            <link>
              <title>Edit Issue</title>
              <pageRef>editIssue</pageRef>
            </link>
          </links>
        </outputList>
      </outputLists>
    </page>
    <page id="newIssue" login-required="true">
      <title>Add New Issue</title>
      <description>
      This page provides a form for submitting a new issue.
        </description>
      <forms>
        <form id="newIssueForm">
          <inputs>
            <input type="text" id="title">
              <entityPropertyRef entity="issue"
                property="title" />
              <title>Issue Title</title>
              <validations>
                <validation type="required"
                  description="Please enter an issue title." />
              </validations>
            </input>
            <input type="textarea" id="description">
              <entityPropertyRef entity="issue"
                property="description" />
              <title>Description</title>
              <validations>
                <validation type="required"
                  description="Please enter a description for your issue." />
              </validations>
            </input>

            <input type="dropdown" id="priority">
              <entityPropertyRef entity="issue"
                property="priority" />
            </input>

            <input type="dropdown" id="assignee">
              <entityPropertyRef entity="issue"
                property="assignee" />
              <validations>
                <validation type="required" description="Please check one assignee" />
              </validations>
            </input>
            <!--
              <input type="multiple"> <title>Components</title>
              <validations> <validation type="required" description="You
              must choose at least one component." /> </validations>
              <options> <option value="view">View Layer</option> <option
              value="model">Model Layer</option> <option
              value="controller">Controller Layer</option> </options>
              </input>
            -->
            <input type="radio" id="environment">
              <entityPropertyRef entity="issue"
                property="environment" />
            </input>
          </inputs>
          <actions>
            <action id="create" type="create">
              <title>Save New Issue</title>
              <outcomes>
                <outcome id="issueSaved">
                  <title>Issue Saved</title>
                  <pageRef>viewIssue</pageRef>
                  <message>
                  Issue saved successfully.
                    </message>
                </outcome>
              </outcomes>
            </action>
          </actions>
        </form>
      </forms>
      <linkSetRefs>
        <linkSetRef id="authenticated" />
      </linkSetRefs>
      <links>
        <link>
          <title>Cancel</title>
          <pageRef>viewIssues</pageRef>
        </link>
      </links>
    </page>
    <page id="viewIssue" login-required="true">
      <title>View Issue</title>
      <description>
      This page displays the details of an issue.
        </description>
      <params>
        <param type="text" id="issueId" required="true">
          <entityPropertyRef entity="issue" property="id" />
          <title>Issue ID</title>
          <description>
          Unique identifier of issue to be viewed.
            </description>
        </param>
      </params>
      <outputs>
        <output id="issue" entity="issue">
          <title>Issue</title>
          <description>The issue viewed on this page</description>
        </output>
      </outputs>
      <actions>
        <action id="resolve" type="update">
          <title>Resolve Issue</title>
          <outcomes>
            <outcome id="issueResolved">
              <title>Issue Resolved</title>
              <pageRef>viewIssues</pageRef>
              <message>
              Issue resolved!
                </message>
            </outcome>
          </outcomes>
        </action>
      </actions>
      <linkSetRefs>
        <linkSetRef id="authenticated" />
      </linkSetRefs>
      <links>
        <link>
          <title>Edit Issue</title>
          <pageRef>editIssue</pageRef>
        </link>
      </links>
    </page>
    <page id="editIssue" login-required="true">
      <title>Edit Issue</title>
      <description>
      This page allows the user to modify an existing issue.
        </description>
      <params>
        <param type="text" required="true" id="issueId">
          <entityPropertyRef entity="issue" property="id" />
          <title>Issue ID</title>
          <description>
          Unique identifier of issue to be modified.
            </description>
        </param>
      </params>

      <outputs>
        <output entity="issue" id="issue">
          <title>Issue</title>
          <description>The issue being edited</description>
        </output>
      </outputs>

      <forms>
        <form id="editIssueForm">
          <inputs>
            <input type="text" id="issueTitle">
              <entityPropertyRef entity="issue"
                property="title" />
              <title>Issue Title</title>
              <validations>
                <validation type="required"
                  description="Please enter an issue title." />
              </validations>
            </input>
            <input type="textarea" id="description">
              <entityPropertyRef entity="issue"
                property="description" />
              <title>Description</title>
              <validations>
                <validation type="required"
                  description="Please enter a description for your issue." />
              </validations>
            </input>
            <input type="dropdown" id="priority">
              <entityPropertyRef entity="issue"
                property="priority" />
              <title>Priority</title>
              <validations>
                <validation type="required" description="Please enter a priority." />
              </validations>
            </input>
            <input type="dropdown" id="owner">
              <entityPropertyRef entity="issue"
                property="assignee" />
              <validations>
                <validation type="required" description="Please enter an owner." />
              </validations>
            </input>
            <input type="radio" id="environment">
              <entityPropertyRef entity="issue"
                property="environment" />
              <validations>
                <validation type="required"
                  description="Please enter an environment." />
              </validations>
            </input>
          </inputs>

          <actions>
            <action id="updateIssue" type="update">
              <title>Update Issue</title>
              <outcomes>
                <outcome id="issueUpdated">
                  <title>Issue Saved</title>
                  <pageRef>viewIssue</pageRef>
                  <message>
                  Issue saved successfully.
                    </message>
                </outcome>
              </outcomes>
            </action>
          </actions>
        </form>
      </forms>

      <linkSetRefs>
        <linkSetRef id="authenticated" />
      </linkSetRefs>
      <links>
        <link>
          <title>Cancel</title>
          <pageRef>viewIssue</pageRef>
        </link>
      </links>
    </page>
    <page id="contact">
      <title>Contact Issue Tracker</title>
      <description>
      This page displays our corporate contact information,
      including
      address, phone number, and key e-mail addresses.
        </description>
    </page>
    <page id="privacy">
      <title>Privacy Policy</title>
      <description>
      This page displays the corporate privacy policy.
        </description>
      <links>
        <link>
          <title>Contact Legal Department</title>
          <href>mailto:legal@issuetracker.com
      </href>
        </link>
      </links>
    </page>

    <page id="about">
        <title>About this demo</title>
        <description>This application is 100% generated from the XML specification. The application is generated by running the 
        Seam2 plugin against the appspec.</description>
        <links>
            <link>
                <title>Google code project</title>
                <href>http://code.google.com/p/clickframes-seam-issuetracker-demo/</href>
            </link>
            <link>
                <title>Browse source code</title>
                <href>http://code.google.com/p/clickframes-seam-issuetracker-demo/source/browse/#svn/trunk</href>
            </link>
            <link>
                <title>View Appspec.xml</title>
                <href>http://code.google.com/p/clickframes-seam-issuetracker-demo/source/browse/trunk/src/main/clickframes/appspec.xml</href>
            </link>
            <link>
                <title>View Techspec.xml</title>
                <href>http://code.google.com/p/clickframes-seam-issuetracker-demo/source/browse/trunk/src/main/clickframes/techspec.xml</href>
                <facts>
                    <fact>The techspec.xml file contains a list of all the plugins which should be run for this project</fact>
                </facts>
            </link>
        </links>
    </page>

    <page id="error">
      <title>Operational Error</title>
      <description>
      Should an unexpected operational error occur during any
      transition,
      this page will appear with instructions on available
      support
      resources.
        </description>
    </page>
  </pages>

  <emails>
    <email id="newAccountMessage">
      <title>New Account Message</title>
      <description>
      This e-mail is sent to all new users upon creating
      an
      account.
        </description>
      <emailSubject>Welcome to Issue Tracker</emailSubject>
      <emailText>
        <![CDATA[
Dear FIRSTNAME LASTNAME,
Your account has been created.
Please log in at APPLICATIONURL with your username USERNAME.
Regards,
Issue Tracker
        ]]>
    </emailText>
      <facts>
        <fact>
        E-mail shall include the user's first and last name.
        </fact>
        <fact>
        E-mail shall include a URL where the user may log in.
        </fact>
        <fact>
        E-mail shall include the user's username.
        </fact>
      </facts>
    </email>
  </emails>
</appspec>